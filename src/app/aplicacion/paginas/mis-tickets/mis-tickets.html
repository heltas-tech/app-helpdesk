<div class="min-h-screen bg-gray-50 p-6">
  <!-- Header -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
    <div class="flex justify-between items-center">
      <div>
        <h1 class="text-2xl font-bold text-gray-900">Mis Tickets</h1>
        <p class="text-gray-600 mt-1">Gestiona y revisa todos tus tickets de soporte</p>
      </div>
      <button 
        class="flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
        routerLink="/crear-ticket">
        <span class="mr-2">üìù</span>
        Nuevo Ticket
      </button>
    </div>
  </div>

  <!-- Barra de B√∫squeda -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-6">
    <div class="flex gap-4 items-center">
      <div class="flex-1 relative">
        <input
          type="text"
          [(ngModel)]="textoBusqueda"
          (input)="aplicarBusqueda()"
          placeholder="Buscar en tickets..."
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        <span class="absolute right-3 top-2 text-gray-400"></span>
      </div>
      <button
        (click)="limpiarBusqueda()"
        class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
        Limpiar
      </button>
    </div>
  </div>

  <!-- Tabla de Tickets -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
    <div class="overflow-x-auto">
      <table mat-table [dataSource]="dataSource" class="w-full">
        
        <!-- ID -->
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">ID</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3 text-sm text-gray-900 font-medium">
            #{{ticket.id}}
          </td>
        </ng-container>

        <!-- Asunto -->
        <ng-container matColumnDef="asunto">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">Asunto</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3">
            <div class="max-w-xs">
              <div class="text-sm font-medium text-gray-900 truncate">{{ticket.titulo}}</div>
              <div class="text-xs text-gray-500 truncate" [innerHTML]="getDescripcionCorta(ticket)"></div>
            </div>
          </td>
        </ng-container>

        <!-- Estado -->
        <ng-container matColumnDef="estado">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">Estado</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                  [ngClass]="getEstadoClase(ticket)">
              <span class="mr-1 text-xs">{{getEstadoIcono(ticket)}}</span>
              {{getEstadoTexto(ticket)}}
            </span>
          </td>
        </ng-container>

        <!-- T√©cnico Asignado -->
        <ng-container matColumnDef="tecnico_asignado">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">T√©cnico</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3 text-sm text-gray-900">
            <div *ngIf="tieneTecnico(ticket)" class="flex items-center">
              <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs text-blue-600 mr-2">
                üë§
              </div>
              <div>
                <div class="font-medium">{{getNombreTecnico(ticket)}}</div>
                <div class="text-xs text-gray-500">{{getEmailTecnico(ticket)}}</div>
              </div>
            </div>
            <span *ngIf="!tieneTecnico(ticket)" class="text-gray-400 italic">Sin asignar</span>
          </td>
        </ng-container>

        <!-- Prioridad -->
        <ng-container matColumnDef="prioridad">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">Prioridad</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3">
            <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium"
                  [ngClass]="getPrioridadClase(ticket)">
              <span class="w-2 h-2 rounded-full mr-1" [ngClass]="getPrioridadPuntoClase(ticket)"></span>
              {{ticket.prioridad?.nombre || 'No especificada'}}
            </span>
          </td>
        </ng-container>

        <!-- Categor√≠a -->
        <ng-container matColumnDef="categoria">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">Categor√≠a</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3 text-sm text-gray-900">
            <div class="max-w-xs truncate">
              {{ticket.categoria?.nombre || 'General'}}
              <span *ngIf="ticket.subcategoria?.nombre" class="text-xs text-gray-500">
                / {{ticket.subcategoria.nombre}}
              </span>
            </div>
          </td>
        </ng-container>

        <!-- Fecha Creaci√≥n -->
        <ng-container matColumnDef="fecha_creacion">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">Creado</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3 text-sm text-gray-900">
            <div>{{ticket.fecha_creacion | date:'dd/MM/yyyy'}}</div>
            <div class="text-xs text-gray-500">{{ticket.fecha_creacion | date:'HH:mm'}}</div>
          </td>
        </ng-container>

        <!-- Tiempo Espera -->
        <ng-container matColumnDef="tiempo_espera">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">Tiempo</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3 text-sm text-gray-900">
            {{getTiempoTranscurrido(ticket.fecha_creacion)}}
          </td>
        </ng-container>

        <!-- Acciones -->
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef class="px-4 py-3 text-left text-sm font-semibold text-gray-900">Acciones</th>
          <td mat-cell *matCellDef="let ticket" class="px-4 py-3">
            <div class="flex gap-2">
              <button
                (click)="abrirDetalleTicket(ticket)"
                class="flex items-center px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm">
                <span class="mr-1">üëÅÔ∏è</span>
                Ver
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="bg-gray-50"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
            class="border-b border-gray-200 hover:bg-gray-50 transition-colors"></tr>
      </table>
    </div>

    <!-- Sin resultados -->
    <div *ngIf="dataSource.filteredData.length === 0" class="text-center py-12">
      <div class="text-6xl mb-4">üì≠</div>
      <h3 class="text-lg font-semibold text-gray-900 mb-2">No se encontraron tickets</h3>
      <p class="text-gray-600 mb-4">No hay tickets que coincidan con tu b√∫squeda</p>
      <button 
        (click)="limpiarBusqueda()"
        class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
        Limpiar b√∫squeda
      </button>
    </div>

    <!-- Paginaci√≥n -->
    <mat-paginator
      [pageSize]="10"
      [pageSizeOptions]="[5, 10, 20, 50]"
      showFirstLastButtons
      class="bg-gray-50 border-t border-gray-200">
    </mat-paginator>
  </div>
</div>